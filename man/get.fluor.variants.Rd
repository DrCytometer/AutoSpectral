% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_fluor_variants.R
\name{get.fluor.variants}
\alias{get.fluor.variants}
\title{Get Fluorophore Variants}
\usage{
get.fluor.variants(
  fluor,
  file.name,
  control.dir,
  asp,
  spectra,
  af.spectra,
  n.cells,
  som.dim,
  figures,
  output.dir,
  verbose,
  spectral.channel,
  universal.negative,
  control.type,
  raw.thresholds,
  unmixed.thresholds,
  flow.channel,
  refine = TRUE,
  problem.quantile = 0.95
)
}
\arguments{
\item{fluor}{The name of the fluorophore.}

\item{file.name}{A named vector of file names for the samples.}

\item{control.dir}{The directory containing the control files.}

\item{asp}{The AutoSpectral parameter list.}

\item{spectra}{A matrix containing the spectral data. Fluorophores in rows,
detectors in columns.}

\item{af.spectra}{Spectral signatures of autofluorescences, normalized
between 0 and 1, with fluorophores in rows and detectors in columns. Prepare
using \code{get.af.spectra}.}

\item{n.cells}{Numeric. Number of cells to use for defining the variation in
spectra. Up to \code{n.cells} cells will be selected as positive events in the peak
channel for each fluorophore, above the 99.5th percentile level in the
unstained sample.}

\item{som.dim}{Numeric. Number of x and y dimensions to use in the SOM for
clustering the spectral variation.}

\item{figures}{Logical, controls whether the variation in spectra for each
fluorophore is plotted in \code{output.dir}. Default is \code{TRUE}.}

\item{output.dir}{File path to whether the figures and .rds data file will be
saved. Default is \code{NULL}, in which case \code{asp$variant.dir} will be used.}

\item{verbose}{Logical, default is \code{TRUE}. Set to \code{FALSE} to suppress messages.}

\item{spectral.channel}{A vector of spectral channels.}

\item{universal.negative}{A named vector of unstained negative samples, with
names corresponding to the fluorophores.}

\item{control.type}{Character, either "beads" or "cells". Determines the type
of control sample being used and the subsequent processing steps.}

\item{raw.thresholds}{A named vector of numerical values corresponding to
the threshold for positivity in each raw detector channel. Determined by the
99.5th percentile on the unstained sample, typically.}

\item{unmixed.thresholds}{A named vector of numerical values corresponding to
the threshold for positivity in each unmixed channel. Determined by the
99.5th percentile on the unstained sample, typically after single-cell AF
unmixing.}

\item{flow.channel}{A named vector of peak raw channels, one per fluorophore.}

\item{refine}{Logical, default is \code{TRUE}. Controls whether to perform a second
round of variation measurement on "problem cells", which are those with the
highest spillover, as defined by \code{problem.quantile}.}

\item{problem.quantile}{Numeric, default \code{0.95}. The quantile for determining
which cells will be considered "problematic" after unmixing with per-cell AF
extraction. Cells in the \code{problem.quantile} or above with respect to total
signal in the fluorophore (non-AF) channels after per-cell AF extraction will
be used to determine additional autofluorescence spectra, using a second round
of clustering and modulation of the previously selected autofluorescence
spectra. A value of \code{0.95} means the top 5\% of cells, those farthest from zero,
will be selected for further investigation.}
}
\value{
A matrix with the flow expression data.
}
\description{
Assesses variation in the spectral signature of a single-stained flow
cytometry control sample. Uses SOM-based clustering on the brightest positive
events in the file.
}
